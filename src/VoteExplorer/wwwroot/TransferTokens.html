<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="lib/jquery/dist/jquery.js"></script>
    <link href="app.css" rel="stylesheet">
    <script src="lib/web3/dist/web3.min.js"></script>
    <script src="lib/crypto-js/crypto-js.js"></script>
    <script>
        var accounts;
        var account;

        var voteSessionABI;
        var voteSessionContract;
        var deployedVotingSession;
        var votingTokenABI;
        var votingTokenContract;
        var deployedVotingToken;

        var currentTokenName;
        var currentTokenSymbol;
        var currentTokenDecimal;

        $(document).ready(function () {

        });

        window.App = {
            start: function () {

            }
        };

        function loadToken() {
            var self = this;
            web3.eth.getAccounts(function (err, accs) {
                if (err != null) {
                    alert("There was an error fetching your accounts.");
                    return;
                }
                if (accs.length == 0) {
                    alert("Couldn't get any accounts! Make sure your Ethereum client is configured correctly.");
                    return;
                }

                accounts = accs;
                account = accounts[0];
                web3.eth.defaultAccount = account;

                votingTokenABI = "[{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_spender\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"_totalSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"transferfrom\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"balance\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_spender\",\"type\":\"address\"}],\"name\":\"allowance\",\"outputs\":[{\"name\":\"remaining\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_spender\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"}]";
                votingTokenContract = web3.eth.contract(JSON.parse(votingTokenABI));
                console.log("got here");
                console.log(votingTokenContract);
                var voteTokenAdd = document.getElementById("tokenAddress").value;
                console.log(voteTokenAdd);
                deployedVotingToken = votingTokenContract.at(voteTokenAdd);
                deployedVotingToken.symbol.call(function (error, symbol) {
                    $("#tokenSymbol").text(symbol);
                    console.log(error);
                    deployedVotingToken.name.call(function (error, name) {
                        console.log("what " + error);
                        $("#tokenName").text(name);
                        deployedVotingToken.decimals.call(function (error, decimal) {
                            currentTokenDecimal = decimal;
                            deployedVotingToken.balanceOf.call(account, function (error, balance) {
                                $("#balance").text(balance);
                            });
                        });
                    });
                });

            })
        }

        function SendMoney()
        {
            var sendTo = document.getElementById("receiverAddress").value;
            var amount = document.getElementById("amount").value;
            deployedVotingToken.transfer(sendTo, amount, function (error) {


            });
        }

    </script>
</head>
<body>
    <table>
        <tr><td>Token Address:<td></tr><tr><td><input type="text" id="tokenAddress" /><input type="button" onclick="loadToken();" value="Load" /> </td></tr>
        <tr><td>Token Name:<span id="tokenName"></span></td></tr>
        <tr><td>Token Symbol:<span id="tokenSymbol"></span></td></tr>
        <tr><td>Balance:<span id="balance"></span></td></tr>
        <tr><td>Send To:<input type="text" id="receiverAddress" /></td></tr>
        <tr><td>Amount:<input type="text" id="amount" /><input type="button" onclick="SendMoney();" value="Send" /></td></tr>
    </table>
</body>
</html>